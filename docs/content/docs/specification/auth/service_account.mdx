---
title: Service Account
description: An identity used by NodeActor to execute nodes
---

A ServiceAccount defines the authentication and authorization context for node execution. It provides credentials and context variables that nodes need to access external services and resources.

## Specification

```yaml
kind: ServiceAccount
name: string
context?: Context
# Either one of the options below is allowed
credentials_provider?: CredentialsProvider
credentials_providers?: CredentialsProvider[]
```

import { TypeTable } from "fumadocs-ui/components/type-table";

<TypeTable
  type={{
    kind: {
      description: "The kind of the specification, must be 'ServiceAccount'.",
      required: true,
      type: "ServiceAccount",
    },
    name: {
      type: "string",
      required: true,
    },
    context: {
      type: "Context",
      typeDescriptionLink: "#context",
      description:
        "The context for the ServiceAccount, can be used to inject variables into the service account from the external state.",
    },
    credentials_provider: {
      type: "CredentialProvider",
      typeDescriptionLink: "#credentialsprovider",
      description:
        "A credentials provider for the service account, used to provide credentials for authentication.",
    },
    credentials_providers: {
      type: "CredentialProvider[]",
      typeDescriptionLink: "#credentialsprovider",
      description:
        "Multiple credentials providers for the service account, used to provide multiple credentials for authentication.",
    },
  }}
/>

### Inlined

ServiceAccount can be declared in [inlined format](/docs/specification/internal_types#inlinedtype), in this case `name` and `kind` are not required

```yaml
kind: Node | LLMNode | ToolNode
---
auth:
  service_account:
    name?: string
    context?: Context
    credentials_provider?: CredentialsProvider
    credentials_providers?: CredentialsProvider[]
```

## Context

Context is a set of variables that can be injected into the service account from the external state. It can be used to provide additional information to the service account, such as user ID or organization ID. This way, only the data needed for node execution is used. Context declaration is [always inlined](/docs/specification/internal_types#inlinedtype)

```yaml
context:
  strict: boolean
  inject: var[]
```

<TypeTable
  type={{
    strict: {
      description:
        "If true, throws an error if a variable is not found in the state.",
      type: "boolean",
      default: "true",
    },
    inject: {
      type: "var[]",
      description:
        "List of variables to inject into the service account. Can be a simple variable name (e.g. organization.id) or a variable with custom name assignment using : (e.g. user_id: user.id).",
      required: true,
    },
  }}
/>

### Example

```yaml
context:
  strict: true
  inject:
    - user_id: user.id
    - organization.id
```

Both notations are supported, so you can use `var: user.id` or `organization.id` to inject values from the state.

These would be available in the service account as `context.user_id` and `context.organization.id` variables.

## CredentialsProvider

CredentialsProvider is a phantom specification - it's not declared in YAML, but should be provided to the registry during runtime. Such specifications are needed to keep the YAML specification clean and small. Before node compilation, the required CredentialsProvider should be registered in the Registry - either globally or within the node.

```python title="examples/node.py"
Node.from_yaml(spec, credentials_providers=[MyCredentialsProvider()])
```

It accepts a service account and should return credentials in dict format.

```python
{
    "type": "bearer",
    "data": "string"
}
```

or a more complex structure based on the provider type.

```python
{
    "type": "aws_s3",
    "data": {
        "access_key_id": "string",
        "secret_access_key": "string"
    }
}
```

## Example

This example creates a ServiceAccount that injects project and region variables from the external state and uses both GCP and AWS S3 credentials providers:

```yaml title="yaml"
kind: ServiceAccount
name: MyServiceAccount
context:
  inject: [project_id, region]
credentials_providers:
  - GCPCredentials
  - AWSS3Credentials
```
